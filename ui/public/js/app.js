function chatroom(e){var b=document.getElementById("id-chat");var d=document.getElementById("id-chat__form");var c=document.getElementById("id-chat__form-message");var a=false;function f(k){var j=false;if(k===undefined){k=e.messages.length;j=true;b.innerHTML=""}console.log("Rendering ",k);if(!k){return}var h="";var g;for(i=0;i<k;i++){g=document.createElement("li");g.className+="chat__post";if(e.me==e.messages[i].user){g.className+=" chat__post--me"}g.innerHTML="<span class='chat__datetime'>"+moment(e.messages[i].datetime).format("Do MMM h:mm A")+"</span><span class='chat__user'>"+e.messages[i].user+"</span><span class='chat__message'>"+e.messages[i].message+"</span>";if(j){b.appendChild(g)}else{g.className+=" chat__post--animate";b.insertBefore(g,b.childNodes[0])}}}f();d.onsubmit=function(){var g=c.value;if(g){var h=new XMLHttpRequest();h.open("POST","/api/messages",true);h.setRequestHeader("Content-type","application/x-www-form-urlencoded");h.onreadystatechange=function(){if(h.readyState==4&&h.status==200){var j=JSON.parse(h.responseText);console.log(j);var k=j.length-e.messages.length;e.messages=j;f(k)}a=false};a=true;h.send("ajax=true&message="+g);c.value=""}return false};setInterval(function(){if(a){return}var g=new XMLHttpRequest();g.open("GET","/api/messages",true);g.setRequestHeader("Content-type","application/x-www-form-urlencoded");g.onreadystatechange=function(){if(g.readyState==4&&g.status==200){var h=JSON.parse(g.responseText);var j=h.length-e.messages.length;e.messages=h;f(j)}};g.send()},1000)}if(typeof module!=="undefined"&&module.exports){module.exports=function(){console.log("hello world")}};